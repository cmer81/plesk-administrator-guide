<!DOCTYPE html>
<html>
<head>
<title> Prendre en charge Dist-Upgrade </title>
<meta name="Keywords" content="" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="stylesheet.css"/>
<script src="locate.js"></script>
<link href="prettify.css" rel="stylesheet" />
<script type="text/javascript" src="prettify.js"></script>

</head>
<script src="highlight.js"></script>
<body class="sid-main" onload="FindCorrectTOCPage(); prettyPrint()">
<table class="relatedtopics aboveheading" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="pagenavigation"><a href="60327.htm" target="_self"><img src="38976.gif" alt="Page précédente" height="16" width="16" vspace="0" hspace="1" align="top" border="0"> Page précédente</a></p></td>
<td>
<p class="pagenavigation"><a href="59205.htm" target="_self"><img src="38977.gif" alt="Page suivante" height="16" width="16" vspace="0" hspace="1" align="top" border="0"> Page suivante</a></p></td>
<td>
<p class="pagenavigation"><a href="toc70557101.htm" target="TOC"><img src="38970.gif" alt="Localiser la page" height="16" width="16" vspace="0" hspace="1" align="top" border="0"> Localiser la page</a></p></td>
<td>
<p class="pagenavigation"><a href="toc70557101.htm" target="TOC"><a class="" title="" href="javascript:print();" target="_self"><img src="39072.gif" alt="Imprimer cette page" height="16" width="16" vspace="0" hspace="1" align="top" border="0"></a></a></p></td>
</tr>
</table>
<h2 class="heading2">Prendre en charge Dist-Upgrade</h2>
<p class="bodytext">À compter de Plesk 12.5, vous pouvez mettre à niveau le système d'exploitation sur un serveur Plesk. Les chemins &quot;dist-upgrade&quot; suivants sont pris en charge dans Plesk :</p>
<ul class="listbullet"><li class="listbullet">Debian 6 vers Debian 7</li><li class="listbullet">Debian 7 vers Debian 8</li><li class="listbullet">Ubuntu 12.04 vers Ubuntu 14.04</li><li class="listbullet">Ubuntu 14.04 vers Ubuntu 16.04</li></ul><p class="warning"><strong class="buttons">Attention :</strong> si vous exécutez Plesk sur une distribution Linux qui n'est ni Debian 6 ou 7, ni Ubuntu 12.04 ou 14.04, n'essayez pas de mettre à niveau le système d'exploitation. Ce type de mise à niveau n'est pas pris en charge. Si vous essayez de procéder à la mise à niveau, vous endommagerez votre installation Plesk.</p>
<p class="bodytext"></p>
<p class="warning"><strong class="buttons">Attention :</strong> lisez attentivement toutes les instructions ci-dessous et suivez-les scrupuleusement. Dans le cas contraire, Plesk et ses services risquent de devenir inutilisables.</p>
<p class="bodytext"></p>
<p class="procedureheading">Pour procéder à la mise à niveau &quot;dist-upgrade&quot; suivez ces étapes :</p>
<ol class="listnumber2"><li class="listnumber2">Avant de lancer dist-upgrade, assurez-vous de lire les informations sur les problèmes que vous pouvez rencontrer :<ul class="listbullet3"><li class="listbullet3">Si vous mettez à niveau depuis Debian 6, consultez cet article : <a class="externalhyperlinktemplate" title="" href="https://www.debian.org/releases/wheezy/amd64/release-notes/ch-upgrading.en.html#trouble" target="_blank">https://www.debian.org/releases/wheezy/amd64/release-notes/ch-upgrading.en.html#trouble</a>.</li><li class="listbullet3">Si vous mettez à niveau depuis Debian 7, consultez cet article : <a class="externalhyperlinktemplate" title="" href="https://www.debian.org/releases/stable/i386/release-notes/ch-upgrading.en.html#trouble" target="_blank">https://www.debian.org/releases/stable/i386/release-notes/ch-upgrading.en.html#trouble</a>.</li></ul></li><li class="listnumber2">Exécutez le script de pré-mise à niveau. Ce script est appelé <code class="monospace">distupgrade.helper.&lt;OS.old-OS.new&gt;_pre.sh</code> et se trouve dans le répertoire <code class="monospace">/usr/local/psa/bin</code>.</li><li class="listnumber2">Exécutez la mise à niveau dist-upgrade conformément à la documentation du système d'exploitation :<ul class="listbullet3"><li class="listbullet3"><strong class="specialbold">Debian 6</strong> : Procédez à ces instructions : <a class="externalhyperlinktemplate" title="" href="http://www.debian.org/releases/wheezy/i386/release-notes/ch-upgrading.html" target="_blank">http://www.debian.org/releases/wheezy/i386/release-notes/ch-upgrading.html</a>.  </li><li class="listbullet3"><strong class="specialbold">Debian 7</strong> : Procédez à ces instructions : <a class="externalhyperlinktemplate" title="" href="https://www.debian.org/releases/jessie/i386/release-notes/ch-upgrading.en.html" target="_blank">https://www.debian.org/releases/jessie/i386/release-notes/ch-upgrading.en.html</a>.</li><li class="listbullet3"><strong class="specialbold">Ubuntu 12.04</strong> : Utilisez l'outil <code class="monospace">do-release-upgrade</code> comme décrit ici : <a class="externalhyperlinktemplate" title="" href="https://help.ubuntu.com/14.04/serverguide/installing-upgrading.html" target="_blank">https://help.ubuntu.com/14.04/serverguide/installing-upgrading.html</a>.</li><li class="listbullet3"><strong class="specialbold">Ubuntu 14.04</strong> : Utilisez l'outil <code class="monospace">do-release-upgrade</code> comme décrit ici : <a class="externalhyperlinktemplate" title="" href="https://help.ubuntu.com/lts/serverguide/installing-upgrading.html" target="_blank">https://help.ubuntu.com/lts/serverguide/installing-upgrading.html</a>.</li></ul></li><li class="listnumber2">Exécutez le script de post-mise à niveau. Ce script est appelé <code class="monospace">distupgrade.helper.&lt;OS.old-OS.new&gt;_post.sh</code> et se trouve dans le répertoire <code class="monospace">/usr/local/psa/bin</code>.</li></ol><p class="bodytext">Une fois que le script post-mise à niveau a terminé, Plesk doit être opérationnel et en cours d'exécution. Vous pouvez vérifier le log de mise à niveau <em class="emphasis">/var/log/plesk/install/plesk-distupgrade.log</em> pour en savoir plus sur la mise à niveau.</p>
<h5 class="heading5">Récupérer après un échec de dist-upgrade</h5>
<p class="procedureheading">Pour récupérer après l'échec d'une mise à niveau dist-upgrade, suivez ces étapes :</p>
<p class="procedureheading">Vérifiez les mises à jour des packs système.</p>
<ol class="procedurelistnumber"><li class="procedurelistnumber">Vérifiez si <code class="monospace">/etc/apt/sources.list</code> et si les répertoires dans <code class="monospace">/etc/apt/sources.list.d/</code> ont basculé vers la nouvelle révision de l'OS, par ex. &quot;jessie&quot; si vous mettez à niveau vers Debian 8, &quot;wheezy&quot;, vers Debian 7, &quot;trusty&quot; vers Ubuntu 14.04 et &quot;xenial&quot; vers Ubuntu 16.04.</li><li class="procedurelistnumber">Exécutez les commandes <code class="monospace">apt-get update</code>, <code class="monospace">apt-get upgrade</code> et <code class="monospace">apt-get dist-upgrade</code>. Si aucun pack ne doit être mis à jour, alors les mises à niveau ont déjà été installées. Sinon, les packs doivent être mis à niveau. Pour en savoir plus, consultez la section <strong class="specialbold">Mettez à niveau les packs</strong> ci-dessous.</li></ol><p class="procedureheading">Vérifiez les mises à jour des packs Plesk.</p>
<ol class="procedurelistnumber"><li class="procedurelistnumber">Inspectez la liste des packs installés. Exécutez la commande <code class="monospace">dpkg -l | less</code>. Les packs Plesk contiennent généralement les préfixes ou les suffixes &quot;<em class="emphasis">plesk-</em>&quot;, &quot;<em class="emphasis">psa</em>&quot; ou &quot;<em class="emphasis">sw-</em>&quot;. Vérifiez si la version de chaque pack Plesk contient le nom de l'OS vers lequel vous mettez à niveau, par ex. &quot;debian8&quot; si vous mettez à niveau depuis Debian 7.</li><li class="procedurelistnumber">Si la version des packs Plesk contient le nom de l'OS depuis lequel vous mettez à niveau (par ex.  &quot;debian6&quot; si vous mettez à niveau depuis Debian 6), alors ces packs doivent être mis à niveau. Pour en savoir plus, consultez la section <strong class="specialbold">Mettez à niveau les packs</strong> ci-dessous.</li></ol><p class="procedureheading">Mettez à niveau les packs.</p>
<ol class="procedurelistnumber"><li class="procedurelistnumber">Activez les répertoires Plesk.<ol class="procedurelistnumber2"><li class="procedurelistnumber2">Exécutez la commande <code class="monospace">plesk-installer --skip-cleanup</code> (ajoutez des options le cas échéant).</li><li class="procedurelistnumber2">Sélectionnez la version de Plesk actuellement installée, par ex. Onyx.</li><li class="procedurelistnumber2">Attendez le chargement de la liste des composants, puis annulez l'installation.</li><li class="procedurelistnumber2">Le fichier <code class="monospace">/etc/apt/sources.list.d/50sw_autoinstaller.list</code> sera alors créé.</li></ol></li><li class="procedurelistnumber">Modifiez les répertoires apt (<code class="monospace">/etc/apt/sources.list</code> et <code class="monospace">/etc/apt/sources.list.d/*.list</code>) en remplaçant le nom de code de l'OS par le nouveau nom de code, c'est-à-dire, remplacez &quot;precise&quot; par &quot;trusty&quot;, &quot;trusty&quot; par &quot;xenial&quot;, &quot;squeeze&quot; par &quot;wheezy&quot; et &quot;wheezy&quot; par &quot;jessie&quot;.</li><li class="procedurelistnumber">Mettez à niveau les packs.<ol class="procedurelistnumber2"><li class="procedurelistnumber2">Exécutez la commande <code class="monospace">apt-get update</code>.</li><li class="procedurelistnumber2">Exécutez la commande <code class="monospace">apt-get upgrade</code>.</li><li class="procedurelistnumber2">Exécutez la commande <code class="monospace">apt-get dist-upgrade</code>.</li><li class="procedurelistnumber2">Si l'installation des packs échoue, exécutez la commande <code class="monospace">apt-get install -f</code> pour reconfigurer les packs qui n'ont pas été installés, résolvez les erreurs et réessayez.</li></ol></li></ol><p class="procedureheading">Mettez à niveau les composants de Plesk.</p>
<ol class="procedurelistnumber"><li class="procedurelistnumber">Une fois que les packs ont été mis à niveau, réexécutez le Programme d'installation de Plesk et installez les mises à jour des composants installés.</li></ol><p class="procedureheading">Réparez Plesk.</p>
<ol class="procedurelistnumber"><li class="procedurelistnumber">Exécutez la commande <code class="monospace">plesk repair installation</code>.</li><li class="procedurelistnumber">Exécutez la commande <code class="monospace">plesk repair all -n</code> pour vérifier s'il y a des problèmes avec la configuration de Plesk.</li><li class="procedurelistnumber">Si des problèmes sont détectés, vous pouvez essayer de les résoudre automatiquement avec la commande de réparation de Plesk <code class="monospace">plesk repair mail</code> ou <code class="monospace">plesk repair web</code>). En cas d'échec, essayez de résoudre manuellement les problèmes détectés ou contactez l'assistance.</li></ol><h5 class="heading5">Problèmes potentiels</h5>
<ul class="listbullet2"><li class="listbullet2">Lors de la configuration d'Apache, le message d'erreur &quot;<em class="emphasis">API module structure...is garbled</em>&quot; indique qu'Apache a été mis à jour, mais un ou plusieurs modules n'ont pas été mis à jour. Désactivez les modules concernés pour résoudre le problème.</li><li class="listbullet2">Lors de la configuration d'Apache, le message d'erreur &quot;<em class="emphasis">No matches for the wildcard '*.conf</em>&quot; indique qu'Apache a été mis à jour, mais un ou plusieurs de ses fichiers de configuration disponibles dans <code class="monospace">/etc/apache2/conf.d</code> et dans <code class="monospace">/etc/apache2/plesk.conf.d</code> contiennent toujours la directive <code class="monospace">Include</code> avec l'ancienne syntaxe. Remplacez <code class="monospace">Include</code> par <code class="monospace">IncludeOptional</code> pour résoudre ce problème.</li><li class="listbullet2">Lors du démarrage d'Apache, le message d'erreur &quot;<em class="emphasis">Could not open configuration file ...</em>&quot; indique que le fichier spécifié est un lien symbolique qui pointe vers un fichier inexistant. Supprimez le lien symbolique pour résoudre ce problème.</li><li class="listbullet2">Lors du démarrage d'Apache, le message d'erreur &quot;<em class="emphasis">Invalid command 'LockFile'</em> indique qu'Apache a été mis à jour, mais le fichier <code class="monospace">/etc/apache2/apache2.conf</code> contient la directive obsolète <code class="monospace">LockFile</code>. Remplacez la ligne</li></ul><pre class="preformatted">LockFile ${APACHE_LOCK_DIR}/accept.lock</pre>
<p class="listcontinue2">par la ligne</p>
<pre class="preformatted">Mutex file:${APACHE_LOCK_DIR} default</pre>
<p class="listcontinue2">pour résoudre ce problème.</p>
<ul class="listbullet2"><li class="listbullet2">Lors du démarrage d'Apache, le message d'erreur &quot;<em class="emphasis">SSLSessionCache ... session cache not supported</em>&quot; peut indiquer que le fichier <code class="monospace">socache_shmcb.load</code> est absent. Exécutez la commande suivante</li></ul><pre class="preformatted">cp /etc/apache2/mods-available/socache_shmcb.load /etc/apache2/mods-enabled/</pre>
<p class="listcontinue2">pour résoudre ce problème. Modifiez également le fichier <em class="emphasis">/etc/apache2/mods-enabled/ssl.conf</em> et remplacez la ligne :</p>
<pre class="preformatted">SSLMutex file:${APACHE_RUN_DIR}/ssl_mutex</pre>
<p class="listcontinue2">par la ligne</p>
<pre class="preformatted">Mutex file:${APACHE_LOCK_DIR} ssl-cache</pre>
<p class="listcontinue2">pour éviter un autre problème.</p>
<ul class="listbullet2"><li class="listbullet2">Lors de la configuration d'Apache, le message d'erreur &quot;<em class="emphasis">Invalid command 'Order'</em>&quot; indique qu'Apache a été mis à jour, mais un ou plusieurs de ses fichiers de configuration disponibles dans <code class="monospace">/etc/apache2/conf.d</code> et dans <code class="monospace">/etc/apache2/plesk.conf.d</code> contiennent toujours la directive obsolète <code class="monospace">Order</code>. Remplacez les lignes</li></ul><pre class="preformatted">Order allow,deny</pre>
<pre class="preformatted">Allow from all</pre>
<p class="listcontinue2">par</p>
<pre class="preformatted">Require all granted</pre>
<p class="listcontinue2">pour résoudre ce problème.</p>
<ul class="listbullet2"><li class="listbullet2">Le message d'erreur &quot;<em class="emphasis">Config file dir.conf not properly enabled</em>&quot; peut indiquer que le fichier <code class="monospace">/etc/apache2/mods-enabled/dir.conf</code> est un fichier réel au lieu d'un lien symbolique. Supprimez le fichier et créez un lien symbolique qui pointe vers <code class="monospace">/etc/apache2/mods-available/dir.conf</code> pour résoudre le problème.</li><li class="listbullet2">Le message d'erreur &quot;<em class="emphasis">Failed to get D-Bus connection</em>&quot; peut indiquer que le switch de <code class="monospace">init</code> vers <code class="monospace">systemd</code> est incomplet. Redémarrez le serveur pour résoudre ce problème.</li></ul>




<!--
<p class="bodytext">
<a target="_blank" title="Send feedback through a web form" href="http://www.parallels.com/en/support/usersdoc/?problemSubject=Feedback+on+Help+Page+" onclick="var u = parent.BODY.location.href;
u = u.replace(/.+\/([^/]+).htm$/,'$1');
u+= '+of+the+'+parent.document.title.replace(/ /g,'+');

this.href+=u;

window.location.reload(false);">Please send us your feedback on this help page.</a></p>
-->



&nbsp;
<hr style="border: none; background-color: grey; color: grey; height: 2px" />
<h3 class="heading3">Leave your feedback on this topic here</h3>
<p class="note">If you have questions or need support, please visit the <a target="_blank" href="http://talk.plesk.com/">Plesk forum</a> or contact your hosting provider.<br>The comments below are for feedback on the documentation only. No timely answers or help will be provided.</p>

    
<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'pleskdocs'; // required: replace example with your forum shortname
		var disqus_developer = 0; 
		var disqus_identifier = '74627.htm';
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
</body>
<script>highlightTOC()</script>
</html>
